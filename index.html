<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calendario dell'Avvento - Costellazioni</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-900 text-white min-h-screen flex flex-col items-center p-4">
    <h1 class="text-3xl font-bold mb-4">Calendario dell'Avvento - Costellazioni</h1>
    <div id="app"></div>

    <!-- React e ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

    <script>
      const { useState, useEffect } = React;

      // 24 costellazioni per ogni giorno di dicembre
      const CONSTELLATIONS = [
        { name: "Orione", options: ["Orione", "Cassiopea", "Pegaso", "Cigno"], description: "Orione Ã¨ una delle costellazioni piÃ¹ riconoscibili, visibile in inverno.", hints: ["Ha una famosa cintura di tre stelle", "Mito del cacciatore", "Visibile in inverno nell'emisfero nord"] },
        { name: "Cassiopea", options: ["Andromeda", "Cassiopea", "Cefeo", "Orsa Minore"], description: "Cassiopea Ã¨ a forma di 'W', visibile nell'emisfero nord.", hints: ["Forma di W o M", "Vicino all'Orsa Minore", "Mito della regina vanitosa"] },
        { name: "Andromeda", options: ["Andromeda", "Cigno", "Orsa Maggiore", "Lira"], description: "Andromeda ospita la famosa Galassia di Andromeda.", hints: ["Figlia di Cassiopea", "Contiene la galassia piÃ¹ vicina", "Facile da vedere in autunno"] },
        { name: "Cigno", options: ["Cigno", "Orione", "Perseo", "Pegaso"], description: "Il Cigno, detto anche Croce del Nord, Ã¨ ben visibile in estate.", hints: ["Forma di croce", "Stella Deneb", "Detto Croce del Nord"] },
        { name: "Lira", options: ["Lira", "Andromeda", "Pegaso", "Orsa Minore"], description: "La Lira contiene la brillante stella Vega.", hints: ["Stella Vega", "Piccola costellazione", "Vicino al Cigno"] },
        { name: "Pegaso", options: ["Pegaso", "Cefeo", "Perseo", "Orsa Maggiore"], description: "Pegaso Ã¨ noto per il grande quadrato di stelle.", hints: ["Grande quadrato", "Cavallo alato", "Mito di Perseo"] },
        { name: "Perseo", options: ["Perseo", "Orione", "Cefeo", "Ercole"], description: "Perseo Ã¨ una costellazione legata al mito di Medusa.", hints: ["Eroe greco", "Vicino ad Andromeda", "Uccise Medusa"] },
        { name: "Orsa Maggiore", options: ["Orsa Maggiore", "Orsa Minore", "Drago", "Cefeo"], description: "L'Orsa Maggiore contiene il Grande Carro.", hints: ["Grande Carro", "Molto estesa", "Guida alla Polare"] },
        { name: "Orsa Minore", options: ["Orsa Minore", "Orsa Maggiore", "Cefeo", "Drago"], description: "L'Orsa Minore ospita la Stella Polare.", hints: ["Stella Polare", "Piccola costellazione", "Guida per orientarsi"] },
        { name: "Cefeo", options: ["Cefeo", "Cassiopea", "Perseo", "Drago"], description: "Cefeo rappresenta un re nella mitologia greca.", hints: ["Marito di Cassiopea", "Costellazione settentrionale", "A forma di casa"] },
        { name: "Drago", options: ["Drago", "Cigno", "Orsa Maggiore", "Cefeo"], description: "Il Drago serpeggia tra Orsa Maggiore e Minore.", hints: ["Forma sinuosa", "Circumpolare", "Vicino a Orsa Maggiore"] },
        { name: "Ercole", options: ["Ercole", "Perseo", "Orione", "Ofiuco"], description: "Ercole Ã¨ una grande costellazione estiva.", hints: ["Eroe mitologico", "Costellazione estiva", "Contiene l'ammasso M13"] },
        { name: "Ofiuco", options: ["Ofiuco", "Ercole", "Scorpione", "Sagittario"], description: "Ofiuco Ã¨ detta anche il 'tredicesimo segno' zodiacale.", hints: ["Porta il serpente", "Vicino allo Scorpione", "Segno extra dello zodiaco"] },
        { name: "Scorpione", options: ["Scorpione", "Sagittario", "Ofiuco", "Bilancia"], description: "Lo Scorpione Ã¨ ben visibile in estate nell'emisfero nord.", hints: ["Forma di scorpione", "Stella Antares", "Visibile in estate"] },
        { name: "Sagittario", options: ["Sagittario", "Scorpione", "Ofiuco", "Bilancia"], description: "Sagittario punta verso il centro della Via Lattea.", hints: ["Arciere", "Vicino allo Scorpione", "Centro della galassia"] },
        { name: "Bilancia", options: ["Bilancia", "Vergine", "Scorpione", "Sagittario"], description: "Bilancia Ã¨ una costellazione zodiacale primaverile.", hints: ["Segno zodiacale", "Tra Vergine e Scorpione", "Piccola costellazione"] },
        { name: "Vergine", options: ["Vergine", "Bilancia", "Leone", "Gemelli"], description: "La Vergine Ã¨ la seconda costellazione piÃ¹ grande.", hints: ["Stella Spica", "Grande estensione", "Segno zodiacale"] },
        { name: "Leone", options: ["Leone", "Vergine", "Cancro", "Gemelli"], description: "Leone Ã¨ facilmente riconoscibile in primavera.", hints: ["Forma di leone", "Stella Regolo", "Segno zodiacale"] },
        { name: "Cancro", options: ["Cancro", "Leone", "Gemelli", "Vergine"], description: "Cancro Ã¨ una costellazione zodiacale poco luminosa.", hints: ["Segno zodiacale", "Vicino a Leone", "Poco visibile"] },
        { name: "Gemelli", options: ["Gemelli", "Cancro", "Leone", "Toro"], description: "I Gemelli rappresentano Castore e Polluce.", hints: ["Due fratelli", "Stelle Castore e Polluce", "Segno zodiacale"] },
        { name: "Toro", options: ["Toro", "Ariete", "Gemelli", "Orione"], description: "Il Toro contiene l'ammasso delle Pleiadi.", hints: ["Segno zodiacale", "Stella Aldebaran", "Pleiadi"] },
        { name: "Ariete", options: ["Ariete", "Toro", "Pesci", "Gemelli"], description: "Ariete Ã¨ una costellazione zodiacale autunnale.", hints: ["Segno zodiacale", "Vicino a Toro e Pesci", "Piccola"] },
        { name: "Pesci", options: ["Pesci", "Ariete", "Acquario", "Capricorno"], description: "Pesci Ã¨ una costellazione zodiacale estesa ma poco luminosa.", hints: ["Segno zodiacale", "Vicino ad Ariete", "Due pesci legati"] },
        { name: "Acquario", options: ["Acquario", "Pesci", "Capricorno", "Ariete"], description: "Acquario Ã¨ una grande costellazione zodiacale.", hints: ["Versatore d'acqua", "Molto estesa", "Segno zodiacale"] },
        { name: "Capricorno", options: ["Capricorno", "Acquario", "Pesci", "Sagittario"], description: "Capricorno Ã¨ una costellazione zodiacale a forma di capra-pesce.", hints: ["Capra con coda di pesce", "Segno zodiacale", "Vicino a Sagittario"] }
      ];

      function App() {
        // For testing: simulate August 18
        const [day, setDay] = useState(18); // in produzione: new Date().getDate() se mese==12

        const [progress, setProgress] = useState(() => {
          return JSON.parse(localStorage.getItem("progress") || "{}");
        });

        useEffect(() => {
          localStorage.setItem("progress", JSON.stringify(progress));
        }, [progress]);

        function handleAnswer(index, choice) {
          const correct = CONSTELLATIONS[index].name;
          setProgress(prev => {
            const entry = prev[index] || { attempts: 0, solved: false, score: 3, usedHints: 0 };
            if (entry.solved) return prev;
            entry.attempts += 1;
            if (choice === correct) {
              entry.solved = true;
            } else {
              entry.score = Math.max(0, entry.score - 1);
            }
            return { ...prev, [index]: entry };
          });
        }

        function useHint(index) {
          setProgress(prev => {
            const entry = prev[index] || { attempts: 0, solved: false, score: 3, usedHints: 0 };
            if (entry.solved || entry.usedHints >= 3) return prev;
            entry.usedHints += 1;
            entry.score = Math.max(0, entry.score - 1);
            return { ...prev, [index]: entry };
          });
        }

        return React.createElement(
          "div",
          { className: "grid grid-cols-2 md:grid-cols-4 gap-4 w-full max-w-6xl" },
          CONSTELLATIONS.map((c, i) => {
            const index = i + 1;
            const entry = progress[i] || { attempts: 0, solved: false, score: 3, usedHints: 0 };
            const locked = index > day;
            if (locked) {
              return React.createElement(
                "div",
                { key: i, className: "p-4 bg-gray-800 rounded-2xl shadow-lg" },
                React.createElement("h2", { className: "text-xl font-bold mb-2" }, `Giorno ${index}`),
                React.createElement("p", { className: "text-gray-500" }, `ðŸ”’ Bloccato fino al giorno ${index}`)
              );
            }

            if (!entry.solved) {
              return React.createElement(
                "div",
                { key: i, className: "p-4 bg-gray-800 rounded-2xl shadow-lg" },
                React.createElement("h2", { className: "text-xl font-bold mb-2" }, `Giorno ${index}`),
                React.createElement("p", { className: "mb-2" }, "Quale costellazione Ã¨ questa?"),
                React.createElement(
                  "div",
                  { className: "flex flex-col gap-2" },
                  c.options.map((opt, j) =>
                    React.createElement(
                      "button",
                      {
                        key: j,
                        onClick: () => handleAnswer(i, opt),
                        className: "px-3 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg"
                      },
                      opt
                    )
                  )
                ),
                React.createElement(
                  "div",
                  { className: "mt-2" },
                  React.createElement(
                    "button",
                    {
                      onClick: () => useHint(i),
                      className: "text-sm text-yellow-400 underline"
                    },
                    `Usa indizio (${entry.usedHints}/3)`
                  ),
                  entry.usedHints > 0 &&
                    React.createElement(
                      "p",
                      { className: "mt-1 italic" },
                      `Indizio: ${c.hints[entry.usedHints - 1]}`
                    )
                ),
                React.createElement(
                  "p",
                  { className: "mt-2 text-sm" },
                  `Punti: ${entry.score}`
                )
              );
            }

            return React.createElement(
              "div",
              { key: i, className: "p-4 bg-gray-800 rounded-2xl shadow-lg" },
              React.createElement("h2", { className: "text-xl font-bold mb-2" }, `Giorno ${index}`),
              React.createElement("p", { className: "text-green-400" }, `âœ… Corretto! Era ${c.name}.`),
              React.createElement("p", { className: "mt-1 text-sm" }, c.description),
              React.createElement("p", { className: "mt-1 text-sm" }, `Punti ottenuti: ${entry.score}`)
            );
          })
        );
      }

      ReactDOM.createRoot(document.getElementById("app")).render(React.createElement(App));
    </script>
  </body>
</html>
