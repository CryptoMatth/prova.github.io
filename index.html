<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calendario dell'Avvento - Costellazioni</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-900 text-white min-h-screen flex flex-col items-center p-4">
    <h1 class="text-3xl font-bold mb-2">Calendario dell'Avvento - Costellazioni</h1>
    <div id="score" class="mb-4 text-lg text-yellow-300"></div>
    <div id="app"></div>

    <!-- React e ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

    <script>
      const { useState, useEffect } = React;

      const CONSTELLATIONS = [
        { name: "Orione", options: ["Orione", "Cassiopea", "Pegaso", "Cigno"], description: "Orione Ã¨ una delle costellazioni piÃ¹ riconoscibili, visibile in inverno.", hints: ["Ha una famosa 'cintura' di tre stelle allineate","Ãˆ legata al mito del cacciatore","Ãˆ ben visibile in inverno nell'emisfero nord"] },
        { name: "Cassiopea", options: ["Andromeda", "Cassiopea", "Cefeo", "Orsa Minore"], description: "Cassiopea Ã¨ una costellazione a forma di 'W', visibile nell'emisfero nord.", hints: ["Ha forma di W o M","Ãˆ vicina all'Orsa Minore","Ãˆ legata al mito della regina Cassiopea"] },
        { name: "Andromeda", options: ["Andromeda", "Perseo", "Ariete", "Pegaso"], description: "Andromeda Ã¨ famosa per la galassia di Andromeda.", hints: ["Ospita una famosa galassia visibile ad occhio nudo","Ãˆ figlia di Cassiopea","Costellazione autunnale"] },
        { name: "Cigno", options: ["Cigno", "Lira", "Aquila", "Orione"], description: "Il Cigno Ã¨ anche chiamato Croce del Nord.", hints: ["Ãˆ a forma di croce","Contiene la stella Deneb","Visibile in estate"] },
        { name: "Pegaso", options: ["Pegaso", "Andromeda", "Perseo", "Cefeo"], description: "Pegaso Ã¨ riconoscibile per il suo grande quadrilatero.", hints: ["Ha un grande quadrilatero di stelle","Cavallo alato della mitologia","Visibile in autunno"] },
        { name: "Toro", options: ["Toro", "Ariete", "Perseo", "Orione"], description: "Il Toro ospita l'ammasso delle Pleiadi.", hints: ["Contiene Aldebaran","Contiene le Pleiadi","Costellazione zodiacale"] },
        { name: "Gemelli", options: ["Gemelli", "Cancro", "Leone", "Toro"], description: "Gemelli rappresenta Castore e Polluce.", hints: ["Due stelle brillanti vicine","Costellazione zodiacale","Mitologia greca: due fratelli"] },
        { name: "Leone", options: ["Leone", "Vergine", "Cancro", "Bilancia"], description: "Leone Ã¨ una costellazione zodiacale di primavera.", hints: ["Forma di leone sdraiato","Stella Regolo","Costellazione zodiacale"] },
        { name: "Vergine", options: ["Vergine", "Bilancia", "Leone", "Scorpione"], description: "Vergine Ã¨ la seconda costellazione piÃ¹ grande.", hints: ["Ospita Spica","Costellazione zodiacale","Visibile in primavera"] },
        { name: "Bilancia", options: ["Bilancia", "Scorpione", "Vergine", "Sagittario"], description: "Bilancia Ã¨ una piccola costellazione zodiacale.", hints: ["Simbolo della giustizia","Tra Vergine e Scorpione","Costellazione zodiacale"] },
        { name: "Scorpione", options: ["Scorpione", "Sagittario", "Ofiuco", "Bilancia"], description: "Scorpione Ã¨ facilmente riconoscibile per la sua forma.", hints: ["Forma a S","Contiene Antares","Costellazione zodiacale"] },
        { name: "Sagittario", options: ["Sagittario", "Scorpione", "Capricorno", "Aquila"], description: "Sagittario Ã¨ ricco di oggetti della Via Lattea.", hints: ["Arciere","Vicino al centro galattico","Costellazione zodiacale"] },
        { name: "Capricorno", options: ["Capricorno", "Acquario", "Sagittario", "Pesci"], description: "Capricorno ha la forma di un caprone con la coda di pesce.", hints: ["Caprone marino","Costellazione zodiacale","Visibile in estate"] },
        { name: "Acquario", options: ["Acquario", "Pesci", "Capricorno", "Ariete"], description: "Acquario Ã¨ una vasta costellazione zodiacale.", hints: ["Il portatore d'acqua","Molte stelle deboli","Costellazione zodiacale"] },
        { name: "Pesci", options: ["Pesci", "Ariete", "Acquario", "Toro"], description: "Pesci Ã¨ una costellazione zodiacale poco luminosa.", hints: ["Due pesci legati","Costellazione zodiacale","Visibile in autunno"] },
        { name: "Ariete", options: ["Ariete", "Toro", "Pesci", "Gemelli"], description: "Ariete segna l'inizio della primavera.", hints: ["Piccola costellazione","Contiene Hamal","Costellazione zodiacale"] },
        { name: "Cefeo", options: ["Cefeo", "Cassiopea", "Andromeda", "Drago"], description: "Cefeo Ã¨ una costellazione a forma di casa.", hints: ["Vicino a Cassiopea","Forma di casetta","Re etiope nella mitologia"] },
        { name: "Drago", options: ["Drago", "Orsa Minore", "Cefeo", "Lira"], description: "Drago si snoda attorno alla Polare.", hints: ["Costellazione circumpolare","Forma sinuosa","Vicino all'Orsa Minore"] },
        { name: "Orsa Maggiore", options: ["Orsa Maggiore", "Orsa Minore", "Drago", "Lince"], description: "Orsa Maggiore contiene il Grande Carro.", hints: ["Facile da riconoscere","Contiene il Grande Carro","Guida alla Stella Polare"] },
        { name: "Orsa Minore", options: ["Orsa Minore", "Orsa Maggiore", "Cefeo", "Drago"], description: "Orsa Minore contiene la Stella Polare.", hints: ["Piccolo Carro","Stella Polare","Costellazione circumpolare"] },
        { name: "Lira", options: ["Lira", "Cigno", "Aquila", "Drago"], description: "Lira contiene la stella Vega.", hints: ["Piccola costellazione","Contiene Vega","Visibile in estate"] },
        { name: "Aquila", options: ["Aquila", "Cigno", "Lira", "Sagittario"], description: "Aquila contiene la stella Altair.", hints: ["Stella Altair","Visibile in estate","Fa parte del Triangolo Estivo"] },
        { name: "Perseo", options: ["Perseo", "Andromeda", "Cassiopea", "Auriga"], description: "Perseo Ã¨ legato al mito di Andromeda.", hints: ["Eroe greco","Vicino ad Andromeda","Contiene Algol"] },
        { name: "Auriga", options: ["Auriga", "Perseo", "Gemelli", "Toro"], description: "Auriga contiene Capella, una delle stelle piÃ¹ brillanti.", hints: ["Contiene Capella","Visibile in inverno","Auriga = cocchiere"] }
      ];

      function App() {
        // Simulazione giorno di agosto (18)
        const [day] = useState(18);
        const [progress, setProgress] = useState(() => JSON.parse(localStorage.getItem("progress") || "{}"));

        useEffect(() => {
          localStorage.setItem("progress", JSON.stringify(progress));
        }, [progress]);

        const totalScore = Object.values(progress).reduce((sum, entry) => sum + (entry.score || 0), 0);

        useEffect(() => {
          document.getElementById("score").innerText = `Punteggio totale: ${totalScore}`;
        }, [totalScore]);

        function handleAnswer(index, choice) {
          const correct = CONSTELLATIONS[index].name;
          setProgress(prev => {
            const entry = prev[index] || { attempts: 0, solved: false, score: 3, usedHints: 0 };
            if (entry.solved) return prev;
            entry.attempts += 1;
            if (choice === correct) {
              entry.solved = true;
            } else {
              entry.score = Math.max(0, entry.score - 1);
            }
            return { ...prev, [index]: entry };
          });
        }

        function useHint(index) {
          setProgress(prev => {
            const entry = prev[index] || { attempts: 0, solved: false, score: 3, usedHints: 0 };
            if (entry.solved || entry.usedHints >= 3) return prev;
            entry.usedHints += 1;
            entry.score = Math.max(0, entry.score - 1);
            return { ...prev, [index]: entry };
          });
        }

        return React.createElement(
          "div",
          { className: "grid grid-cols-2 md:grid-cols-4 gap-4 w-full max-w-6xl" },
          CONSTELLATIONS.map((c, i) => {
            const index = i + 1;
            const entry = progress[i] || { attempts: 0, solved: false, score: 3, usedHints: 0 };
            const locked = index > day;
            if (locked) {
              return React.createElement(
                "div",
                { key: i, className: "p-4 bg-gray-800 rounded-2xl shadow-lg" },
                React.createElement("h2", { className: "text-xl font-bold mb-2" }, `Giorno ${index}`),
                React.createElement("p", { className: "text-gray-500" }, `ðŸ”’ Bloccato fino al giorno ${index}`)
              );
            }

            if (!entry.solved) {
              return React.createElement(
                "div",
                { key: i, className: "p-4 bg-gray-800 rounded-2xl shadow-lg" },
                React.createElement("h2", { className: "text-xl font-bold mb-2" }, `Giorno ${index}`),
                React.createElement("p", { className: "mb-2" }, "Quale costellazione Ã¨ questa?"),
                React.createElement(
                  "div",
                  { className: "flex flex-col gap-2" },
                  c.options.map((opt, j) =>
                    React.createElement(
                      "button",
                      {
                        key: j,
                        onClick: () => handleAnswer(i, opt),
                        className: "px-3 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg"
                      },
                      opt
                    )
                  )
                ),
                React.createElement(
                  "div",
                  { className: "mt-2" },
                  React.createElement(
                    "button",
                    { onClick: () => useHint(i), className: "text-sm text-yellow-400 underline" },
                    `Usa indizio (${entry.usedHints}/3)`
                  ),
                  entry.usedHints > 0 && React.createElement("p", { className: "mt-1 italic" }, `Indizio: ${c.hints[entry.usedHints - 1]}`)
                ),
                React.createElement("p", { className: "mt-2 text-sm" }, `Punti: ${entry.score}`)
              );
            }

            return React.createElement(
              "div",
              { key: i, className: "p-4 bg-gray-800 rounded-2xl shadow-lg" },
              React.createElement("h2", { className: "text-xl font-bold mb-2" }, `Giorno ${index}`),
              React.createElement("p", { className: "text-green-400" }, `âœ… Corretto! Era ${c.name}.`),
              React.createElement("p", { className: "mt-1 text-sm" }, c.description),
              React.createElement("p", { className: "mt-1 text-sm" }, `Punti ottenuti: ${entry.score}`)
            );
          })
        );
      }

      ReactDOM.createRoot(document.getElementById("app")).render(React.createElement(App));
    </script>
  </body>
</html>
