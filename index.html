<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario dell'Avvento delle Costellazioni</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c;
            color: #e2e8f0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            width: 100%;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 16px;
        }

        .door {
            position: relative;
            background-color: #2d3748;
            border: 2px solid #4a5568;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            aspect-ratio: 1 / 1;
        }

        .door.closed:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
        }

        .door.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .door-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #cbd5e0;
            transition: color 0.3s ease;
        }

        .door-content {
            display: none;
            width: 100%;
            height: 100%;
            padding: 1rem;
            text-align: center;
        }

        .door.open .door-content {
            display: block;
        }

        .door.open .door-number {
            display: none;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.75);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background-color: #2d3748;
            border-radius: 12px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            color: #e2e8f0;
            animation: slideIn 0.5s ease-out;
            position: relative;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #a0aec0;
            transition: color 0.2s;
        }

        .modal-close:hover {
            color: #e2e8f0;
        }
        
        .modal-image {
            max-width: 100%;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .modal-content {
            text-align: left;
        }
        
        .modal-content h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #48bb78; /* Verde per il titolo */
        }
        
        .modal-content p {
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .question-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .question-form label {
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .question-form input {
            background-color: #4a5568;
            border: 1px solid #718096;
            padding: 10px;
            border-radius: 8px;
            color: #e2e8f0;
            outline: none;
        }
        
        .question-form input:focus {
            border-color: #4299e1;
        }
        
        .question-form button {
            background-color: #4299e1;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: background-color 0.2s;
        }
        
        .question-form button:hover {
            background-color: #3182ce;
        }
        
        .message-box {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
            text-align: center;
        }
        
        .message-box.success {
            background-color: #38a169;
            color: white;
        }
        
        .message-box.error {
            background-color: #e53e3e;
            color: white;
        }
        
    </style>
</head>
<body class="bg-gray-900 text-gray-100">
    <div class="container mx-auto p-4">
        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-bold mb-2">Calendario dell'Avvento</h1>
            <h2 class="text-2xl md:text-3xl text-green-400">Le Meraviglie del Cielo Stellato</h2>
            <p class="text-lg text-gray-400 mt-2">Scopri una nuova costellazione ogni giorno fino a Natale!</p>
        </header>
        
        <div id="calendar-grid" class="calendar-grid">
            <!-- Le caselle del calendario verranno generate qui dal JavaScript -->
        </div>
    </div>

    <!-- Modal per le domande e risposte -->
    <div id="question-modal-overlay" class="modal-overlay">
        <div class="modal">
            <span id="question-modal-close" class="modal-close">&times;</span>
            <div id="question-modal-content" class="modal-content">
                <!-- Il contenuto verrà inserito dinamicamente -->
            </div>
        </div>
    </div>
    
    <!-- Modal per la risposta corretta -->
    <div id="success-modal-overlay" class="modal-overlay">
        <div class="modal">
            <span id="success-modal-close" class="modal-close">&times;</span>
            <div class="modal-content">
                <img id="success-modal-image" class="modal-image" src="" alt="Immagine della costellazione">
                <h3 id="success-modal-title"></h3>
                <p id="success-modal-info"></p>
            </div>
        </div>
    </div>

    <script>
        // Funzione per copiare il testo negli appunti
        const copyToClipboard = (text) => {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
        };

        // Dati delle costellazioni, domande e risposte
        const constellations = [
            {
                name: "Orione",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Orione",
                question: "Quale costellazione è famosa per la sua cintura di tre stelle?",
                answer: "Orione",
                info: "La costellazione di Orione è una delle più famose e riconoscibili nel cielo notturno, visibile in tutto il mondo. Le sue tre stelle luminose, Alnitak, Alnilam e Mintaka, formano la 'Cintura di Orione'.",
                day: 1
            },
            {
                name: "Orsa Maggiore",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Orsa+Maggiore",
                question: "Quale costellazione è nota per la sua forma a 'Grande Carro'?",
                answer: "Orsa Maggiore",
                info: "L'Orsa Maggiore è una delle più grandi costellazioni. Sette delle sue stelle più luminose formano un asterismo a forma di mestolo, noto come il 'Grande Carro' o 'Aratro'.",
                day: 2
            },
            {
                name: "Cassiopea",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Cassiopea",
                question: "Quale costellazione ha una forma a 'W' o 'M'?",
                answer: "Cassiopea",
                info: "La costellazione di Cassiopea è riconoscibile per le sue cinque stelle principali che formano una figura a 'W' o 'M', a seconda dell'orientamento. Prende il nome dalla regina mitologica Cassiopea.",
                day: 3
            },
            {
                name: "Leone",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Leone",
                question: "La stella Regolo è la più luminosa di quale costellazione?",
                answer: "Leone",
                info: "La costellazione del Leone è una delle costellazioni dello zodiaco. Regolo, la sua stella più luminosa, si trova al 'cuore' del Leone, ed è una delle stelle più brillanti nel cielo notturno.",
                day: 4
            },
            {
                name: "Cigno",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Cigno",
                question: "Quale costellazione è conosciuta anche come la 'Croce del Nord'?",
                answer: "Cigno",
                info: "Il Cigno è una costellazione ben visibile nei mesi estivi e autunnali. L'asterismo principale, noto come la 'Croce del Nord', è formato dalle sue stelle più luminose, con Deneb che rappresenta la 'coda' del Cigno.",
                day: 5
            },
            {
                name: "Gemelli",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Gemelli",
                question: "Quale costellazione prende il nome da due gemelli mitologici, Castore e Polluce?",
                answer: "Gemelli",
                info: "I Gemelli sono una costellazione dello zodiaco. Le sue due stelle più luminose, Castore e Polluce, sono considerate i 'gemelli' e sono le stelle più facili da trovare nella costellazione.",
                day: 6
            },
            {
                name: "Scorpione",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Scorpione",
                question: "Quale costellazione ha una forma a 'amo da pesca' e la stella rossa Antares?",
                answer: "Scorpione",
                info: "Lo Scorpione è una costellazione dello zodiaco, la sua forma assomiglia a un grande amo da pesca. Antares, la sua stella più luminosa, è una supergigante rossa che si trova nel 'cuore' dello Scorpione.",
                day: 7
            },
            {
                name: "Toro",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Toro",
                question: "Quale costellazione contiene le Pleiadi e Aldebaran?",
                answer: "Toro",
                info: "La costellazione del Toro è una delle più antiche conosciute. Contiene l'ammasso stellare delle Pleiadi (le 'Sette Sorelle') e la stella gigante rossa Aldebaran, che forma l'occhio del Toro.",
                day: 8
            },
            {
                name: "Lira",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Lira",
                question: "Quale costellazione è piccola ma facilmente riconoscibile per la sua stella Vega?",
                answer: "Lira",
                info: "La Lira è una piccola costellazione. La sua stella più luminosa, Vega, è la seconda stella più brillante dell'emisfero boreale ed è una delle tre stelle che formano il 'Triangolo Estivo'.",
                day: 9
            },
            {
                name: "Grande Cane",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Grande+Cane",
                question: "Quale costellazione ospita Sirio, la stella più luminosa del cielo notturno?",
                answer: "Grande Cane",
                info: "La costellazione del Grande Cane è famosa per la presenza di Sirio, la stella più brillante del cielo. Sirio, una stella binaria, è visibile in gran parte del mondo e fa parte del 'Triangolo Invernale'.",
                day: 10
            },
            {
                name: "Boote",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Boote",
                question: "Arcturus è la stella principale di quale costellazione, a forma di 'aquilone'?",
                answer: "Boote",
                info: "Il Boote è una costellazione facilmente riconoscibile per la sua forma a 'aquilone' o 'imbuto'. Arcturus, la sua stella più luminosa, è una delle stelle più brillanti del cielo notturno.",
                day: 11
            },
            {
                name: "Bilancia",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Bilancia",
                question: "Quale costellazione dello zodiaco rappresenta un oggetto inanimato?",
                answer: "Bilancia",
                info: "La Bilancia è una costellazione dello zodiaco. È l'unica costellazione zodiacale a rappresentare un oggetto inanimato, simboleggiando la bilancia di Astrea, dea della giustizia.",
                day: 12
            },
            {
                name: "Sagittario",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Sagittario",
                question: "Quale costellazione è famosa per la sua forma a 'teiera'?",
                answer: "Sagittario",
                info: "Il Sagittario è una costellazione zodiacale. Molte delle sue stelle formano un asterismo noto come la 'Teiera', che è facilmente visibile nel cielo estivo.",
                day: 13
            },
            {
                name: "Pegaso",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Pegaso",
                question: "Quale costellazione è riconoscibile per il suo 'Grande Quadrato'?",
                answer: "Pegaso",
                info: "La costellazione di Pegaso è famosa per l'asterismo noto come il 'Grande Quadrato di Pegaso', formato da quattro delle sue stelle più luminose, che rappresenta il corpo del cavallo alato.",
                day: 14
            },
            {
                name: "Andromeda",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Andromeda",
                question: "La galassia di Andromeda è visibile in quale costellazione?",
                answer: "Andromeda",
                info: "La costellazione di Andromeda prende il nome dalla principessa mitologica. Ospita la Galassia di Andromeda (M31), la galassia a spirale più vicina alla Via Lattea, visibile a occhio nudo in condizioni ottimali.",
                day: 15
            },
            {
                name: "Acquario",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Acquario",
                question: "Quale costellazione dello zodiaco rappresenta una figura che versa acqua?",
                answer: "Acquario",
                info: "L'Acquario è una costellazione dello zodiaco. Rappresenta un uomo che versa acqua da un'urna e si trova in una regione del cielo nota come il 'Mare del Cielo'.",
                day: 16
            },
            {
                name: "Pesci",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Pesci",
                question: "Quale costellazione è formata da due pesci legati da una corda?",
                answer: "Pesci",
                info: "La costellazione dei Pesci è una costellazione zodiacale. È composta da due pesci che nuotano in direzioni opposte, ma sono legati da una corda.",
                day: 17
            },
            {
                name: "Ariete",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Ariete",
                question: "Quale costellazione zodiacale si distingue per la sua forma a 'corna'?",
                answer: "Ariete",
                info: "L'Ariete è una costellazione zodiacale. Le sue stelle principali formano un arco che rappresenta le corna dell'ariete mitologico dal Vello d'Oro.",
                day: 18
            },
            {
                name: "Capricorno",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Capricorno",
                question: "Quale costellazione dello zodiaco rappresenta una creatura con il corpo di capra e la coda di pesce?",
                answer: "Capricorno",
                info: "Il Capricorno è una costellazione zodiacale. Rappresenta una creatura mitologica, una capra con la coda di pesce, nota anche come 'capra di mare'.",
                day: 19
            },
            {
                name: "Cancro",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Cancro",
                question: "Quale costellazione zodiacale è nota per essere molto debole e difficile da vedere?",
                answer: "Cancro",
                info: "Il Cancro è una costellazione zodiacale. È una delle costellazioni più deboli e difficili da individuare nel cielo, ma ospita l'ammasso stellare 'Praesepe', anche noto come 'M44'.",
                day: 20
            },
            {
                name: "Vergine",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Vergine",
                question: "Quale costellazione è la seconda più grande del cielo e ha la stella Spica?",
                answer: "Vergine",
                info: "La Vergine è la seconda costellazione più grande del cielo. La sua stella più luminosa, Spica, è una delle stelle più brillanti visibili dall'emisfero boreale.",
                day: 21
            },
            {
                name: "Pesce Australe",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Pesce+Australe",
                question: "Fomalhaut è la stella principale di quale costellazione, visibile a sud?",
                answer: "Pesce Australe",
                info: "Il Pesce Australe è una costellazione che si trova nell'emisfero celeste australe. La sua stella più luminosa, Fomalhaut, è la stella di prima grandezza più meridionale che si possa vedere dall'Europa.",
                day: 22
            },
            {
                name: "Delfino",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Delfino",
                question: "Quale piccola costellazione estiva ha una forma che ricorda un delfino che salta?",
                answer: "Delfino",
                info: "La costellazione del Delfino è una piccola ma riconoscibile costellazione. Le sue stelle principali formano un piccolo diamante che assomiglia a un delfino che salta fuori dall'acqua.",
                day: 23
            },
            {
                name: "Auroniga",
                image: "https://placehold.co/600x400/2a52be/ffffff?text=Auroniga",
                question: "Capella, la sesta stella più luminosa del cielo, appartiene a quale costellazione?",
                answer: "Auroniga",
                info: "L'Auroniga è una costellazione visibile nell'emisfero settentrionale. La sua stella più luminosa, Capella, è la sesta stella più brillante del cielo notturno, spesso chiamata 'stella capra'.",
                day: 24
            }
        ];

        // Se l'utente non ha visitato il sito prima, inizializza le impostazioni
        if (!localStorage.getItem('unlockedDays')) {
            localStorage.setItem('unlockedDays', '[]');
            localStorage.setItem('openedDoors', '[]');
        }

        const unlockedDays = JSON.parse(localStorage.getItem('unlockedDays'));
        const openedDoors = JSON.parse(localStorage.getItem('openedDoors'));
        
        const calendarGrid = document.getElementById('calendar-grid');
        const questionModalOverlay = document.getElementById('question-modal-overlay');
        const questionModalClose = document.getElementById('question-modal-close');
        const questionModalContent = document.getElementById('question-modal-content');
        const successModalOverlay = document.getElementById('success-modal-overlay');
        const successModalClose = document.getElementById('success-modal-close');
        const successModalImage = document.getElementById('success-modal-image');
        const successModalTitle = document.getElementById('success-modal-title');
        const successModalInfo = document.getElementById('success-modal-info');
        
        const today = new Date();
        const currentDay = today.getDate(); // Per il mese di dicembre, questo numero va da 1 a 31
        const currentMonth = today.getMonth(); // 0 per Gennaio, 11 per Dicembre
        
        const isChristmasSeason = currentMonth === 11 && currentDay <= 24;

        // Funzione per generare le caselle del calendario
        const generateCalendar = () => {
            const calendarGrid = document.getElementById('calendar-grid');
            calendarGrid.innerHTML = '';
            
            for (let i = 1; i <= 24; i++) {
                const door = document.createElement('div');
                door.classList.add('door');
                door.dataset.day = i;
                
                const isOpened = openedDoors.includes(i);
                const isUnlocked = isChristmasSeason ? (i <= currentDay) : true;
                
                if (isOpened) {
                    door.classList.add('open');
                } else {
                    door.classList.add('closed');
                }
                
                if (!isUnlocked && !isOpened) {
                    door.classList.add('disabled');
                }
                
                door.innerHTML = `<span class="door-number">${i}</span>`;
                
                if (isOpened) {
                    const constellation = constellations.find(c => c.day === i);
                    if (constellation) {
                        const content = `
                            <div class="door-content p-2 md:p-4 flex flex-col items-center">
                                <img src="${constellation.image}" alt="${constellation.name}" class="w-full h-auto rounded-lg mb-2 shadow-md">
                                <p class="text-sm font-semibold text-center text-green-300">${constellation.name}</p>
                            </div>
                        `;
                        door.innerHTML = content;
                    }
                }
                
                calendarGrid.appendChild(door);
            }
        };

        // Funzione per mostrare il modal della domanda
        const showQuestionModal = (constellation) => {
            questionModalContent.innerHTML = `
                <img src="${constellation.image}" alt="${constellation.name}" class="modal-image">
                <form id="question-form" class="question-form">
                    <label for="answer-input" class="text-lg md:text-xl font-semibold">${constellation.question}</label>
                    <input type="text" id="answer-input" class="p-2 rounded-lg" placeholder="La tua risposta..." required>
                    <button type="submit">Invia Risposta</button>
                    <div id="message-box" class="message-box hidden"></div>
                </form>
            `;
            questionModalOverlay.classList.add('active');
            
            const form = document.getElementById('question-form');
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                checkAnswer(constellation);
            });
        };

        // Funzione per mostrare il modal di successo
        const showSuccessModal = (constellation) => {
            successModalImage.src = constellation.image;
            successModalImage.alt = constellation.name;
            successModalTitle.textContent = constellation.name;
            successModalInfo.textContent = constellation.info;
            successModalOverlay.classList.add('active');
        };

        // Funzione per nascondere i modal
        const hideModals = () => {
            questionModalOverlay.classList.remove('active');
            successModalOverlay.classList.remove('active');
        };

        // Funzione per controllare la risposta
        const checkAnswer = (constellation) => {
            const answerInput = document.getElementById('answer-input').value.trim();
            const messageBox = document.getElementById('message-box');
            
            if (answerInput.toLowerCase() === constellation.answer.toLowerCase()) {
                messageBox.textContent = "Risposta esatta! Congratulazioni!";
                messageBox.classList.remove('hidden', 'error');
                messageBox.classList.add('success');
                
                // Aggiorna lo stato della porta a "aperta" e salvalo nel localStorage
                if (!openedDoors.includes(constellation.day)) {
                    openedDoors.push(constellation.day);
                    localStorage.setItem('openedDoors', JSON.stringify(openedDoors));
                }

                // Chiudi il modal della domanda e mostra il modal di successo dopo un breve ritardo
                setTimeout(() => {
                    hideModals();
                    showSuccessModal(constellation);
                    generateCalendar(); // Rigenera il calendario per mostrare la porta aperta
                }, 1000);
                
            } else {
                messageBox.textContent = "Risposta errata. Riprova.";
                messageBox.classList.remove('hidden', 'success');
                messageBox.classList.add('error');
            }
        };

        // Aggiungi un gestore di eventi per il click sulle caselle
        document.getElementById('calendar-grid').addEventListener('click', (e) => {
            const door = e.target.closest('.door');
            if (door && !door.classList.contains('disabled')) {
                const day = parseInt(door.dataset.day);
                const constellation = constellations.find(c => c.day === day);
                
                if (constellation) {
                    if (openedDoors.includes(day)) {
                        // Se la porta è già aperta, mostra direttamente le informazioni
                        showSuccessModal(constellation);
                    } else {
                        // Se la porta è bloccata o chiusa, mostra la domanda
                        showQuestionModal(constellation);
                    }
                }
            }
        });

        // Aggiungi gestori di eventi per chiudere i modal
        questionModalClose.addEventListener('click', hideModals);
        successModalClose.addEventListener('click', hideModals);
        questionModalOverlay.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal-overlay')) {
                hideModals();
            }
        });
        successModalOverlay.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal-overlay')) {
                hideModals();
            }
        });
        
        // Genera il calendario al caricamento della pagina
        generateCalendar();
    </script>
</body>
</html>
